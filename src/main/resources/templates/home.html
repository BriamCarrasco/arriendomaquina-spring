<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Inicio | Arriendo de Maquinaria</title>
  <link rel="stylesheet" href="/style.css">
</head>

  <nav class="navbar-app">
    <h2> Arriendo de Maquinaria</h2>
    <div class="right">
      <span sec:authorize="isAuthenticated()" th:inline="text">
        Hola <span class="user-name" sec:authentication="name"></span> 
      </span>
      <a sec:authorize="isAuthenticated()" th:href="@{/logout}" class="btn btn-outline">Cerrar sesi贸n</a>
      <a sec:authorize="isAnonymous()" th:href="@{/login}" class="btn">Iniciar sesi贸n</a>
    </div>
  </nav>

  <main class="container-app">
    <h1 th:text="|Bienvenido a ${name}!|"></h1>
    <h2>Plataforma segura con Spring Security</h2>

    <!--  Contenido visible solo si est谩 autenticado -->
    <div sec:authorize="isAuthenticated()">
      <div class="section-title">
        <span class="badge badge-info">Inicio</span>
        <strong>Acciones r谩pidas</strong>
      </div>

      <div class="card-grid">

        <!-- Buscar maquinaria -->
        <div class="card">
          <h4>Buscar maquinaria</h4>
          <p>Explora equipos disponibles por nombre, categor铆a o estado.</p>
          <div class="actions">
            <a th:href="@{/search}" class="btn">Ir a b煤squeda</a>
          </div>
        </div>

        <!-- Publicar maquinaria -->
        <div class="card">
          <h4>Publicar maquinaria</h4>
          <p>Sube tus propios equipos para arriendo y gestiona su disponibilidad.</p>
          <div class="actions">
            <a th:href="@{/owner/publicar}" class="btn"
               sec:authorize="hasAnyRole('OWNER','ADMIN')">Publicar</a>
            <button class="btn btn-disabled" disabled
                    sec:authorize="!hasAnyRole('OWNER','ADMIN')">Solo propietarios</button>
          </div>
        </div>

        <!-- Panel de administraci贸n -->
        <div class="card">
          <h4>Panel de administraci贸n</h4>
          <p>Gestiona usuarios, auditor铆as y estados de publicaci贸n.</p>
          <div class="actions">
            <a th:href="@{/admin/panel}" class="btn btn-outline"
               sec:authorize="hasRole('ADMIN')">Abrir panel</a>
            <span class="badge badge-info"
                  sec:authorize="!hasRole('ADMIN')">Solo administradores</span>
          </div>
        </div>

        <!-- Resumen -->
        <div class="card">
          <h4>Resumen</h4>
          <p>Consulta el estado general de tus operaciones.</p>
          <div class="actions">
            <span class="badge badge-success">Activo</span>
          </div>
        </div>

        <!-- Reportes -->
        <div class="card">
          <h4>Reportes</h4>
          <p>Genera reportes operativos (pr贸ximamente).</p>
          <div class="actions">
            <a href="#" class="btn btn-outline" onclick="return false;">Ver ejemplo</a>
          </div>
        </div>
      </div>

      <!-- П Nueva secci贸n: listado de maquinarias -->
      <div class="section-title" style="margin-top:32px;">
        <span class="badge badge-info">Inventario</span>
        <strong>Maquinaria disponible</strong>
      </div>

      <div th:if="${maquinarias != null and #lists.size(maquinarias) > 0}">
        <table class="table" border="1" cellspacing="0" cellpadding="6">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Categor铆a</th>
              <th>Estado</th>
              <th>Precio d铆a</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="maq : ${maquinarias}">
              <td th:text="${maq.id}"></td>
              <td th:text="${maq.nombre}"></td>
              <td th:text="${maq.categoria}"></td>
              <td th:text="${maq.estado}"></td>
              <td th:text="${#numbers.formatDecimal(maq.precioDia, 0, 'COMMA', 2, 'POINT')}"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <p th:if="${maquinarias == null or #lists.isEmpty(maquinarias)}">
        No hay maquinarias registradas actualmente.
      </p>

    </div>

    <!--  Invitaci贸n para usuarios an贸nimos -->
    <div sec:authorize="isAnonymous()">
      <div class="section-title">
        <span class="badge badge-info">Acceso</span>
        <strong>Zona privada</strong>
      </div>
      <p>Inicia sesi贸n para acceder a las funciones de la plataforma.</p>
      <a th:href="@{/login}" class="btn">Iniciar sesi贸n</a>
    </div>

  </main>

</body>
</html>
