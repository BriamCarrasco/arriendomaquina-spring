<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>Inicio | Arriendo de Maquinaria</title>
  <link rel="stylesheet" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

  <!-- Barra superior -->
  <nav class="navbar-app">
    <h2>🌾 Arriendo de Maquinaria</h2>
    <div class="right">
      <!-- Estado sesión -->
      <span sec:authorize="isAuthenticated()" th:inline="text">
        Hola <span class="user-name" sec:authentication="name"></span> 👋
      </span>
      <a sec:authorize="isAuthenticated()" th:href="@{/logout}" class="btn btn-outline">Cerrar sesión</a>
      <a sec:authorize="isAnonymous()" th:href="@{/login}" class="btn">Iniciar sesión</a>
    </div>
  </nav>

  <main class="container-app">
    <h1 th:text="|Bienvenido a ${name}!|"></h1>
    <h2>Plataforma segura con Spring Security</h2>

    <!-- 🔒 Contenido visible solo si está autenticado -->
    <div sec:authorize="isAuthenticated()">
      <div class="section-title">
        <span class="badge badge-info">Inicio</span>
        <strong>Acciones rápidas</strong>
      </div>

      <div class="card-grid">

        <!-- Buscar maquinaria (todos los usuarios autenticados) -->
        <div class="card">
          <h4>Buscar maquinaria</h4>
          <p>Explora equipos disponibles por nombre, categoría o estado.</p>
          <div class="actions">
            <a th:href="@{/search}" class="btn">Ir a búsqueda</a>
          </div>
        </div>

        <!-- Publicar maquinaria (OWNER o ADMIN) -->
        <div class="card">
          <h4>Publicar maquinaria</h4>
          <p>Sube tus propios equipos para arriendo y gestiona su disponibilidad.</p>
          <div class="actions">
            <a th:href="@{/owner/publicar}" class="btn"
               sec:authorize="hasAnyRole('OWNER','ADMIN')">Publicar</a>
            <button class="btn btn-disabled" disabled
                    sec:authorize="!hasAnyRole('OWNER','ADMIN')">Solo propietarios</button>
          </div>
        </div>

        <!-- Panel de administración (solo ADMIN) -->
        <div class="card">
          <h4>Panel de administración</h4>
          <p>Gestiona usuarios, auditorías y estados de publicación.</p>
          <div class="actions">
            <a th:href="@{/admin/panel}" class="btn btn-outline"
               sec:authorize="hasRole('ADMIN')">Abrir panel</a>
            <span class="badge badge-info"
                  sec:authorize="!hasRole('ADMIN')">Solo administradores</span>
          </div>
        </div>

        <!-- Resumen general (todos los usuarios autenticados) -->
        <div class="card">
          <h4>Resumen</h4>
          <p>Consulta el estado general de tus operaciones.</p>
          <div class="actions">
            <span class="badge badge-success">Activo</span>
          </div>
        </div>

        <!-- Reportes (placeholder futuro, visible para todos) -->
        <div class="card">
          <h4>Reportes</h4>
          <p>Genera reportes operativos (próximamente).</p>
          <div class="actions">
            <a href="#" class="btn btn-outline" onclick="return false;">Ver ejemplo</a>
          </div>
        </div>
      </div>
    </div>

    <!-- 🚫 Invitación para usuarios anónimos -->
    <div sec:authorize="isAnonymous()">
      <div class="section-title">
        <span class="badge badge-info">Acceso</span>
        <strong>Zona privada</strong>
      </div>
      <p>Inicia sesión para acceder a las funciones de la plataforma.</p>
      <a th:href="@{/login}" class="btn">Iniciar sesión</a>
    </div>

  </main>

</body>
</html>
